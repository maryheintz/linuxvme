#include <stdio.h>#include <math.h>static struct {int nev;               int month;               int day;               int hour;               int min;               double cap;               double cg[100];               double amp[100];               double damp[100];               double ped;               double dped;               double rad;} dacs;char xstring[80],ystring[80],string[80],err[80];int year,month,day,hour,min,sec;int lyear,lmonth,lday,lhour,lmin,lsec;main()  { FILE *fp_dac;    int n,ntotal=0,i,ierr,nwds,cardno;    double dmin,rad;    printf("input - card number\n");    fscanf(stdin,"%d",&cardno);    sprintf(string,"/z5/dac%d.dat",cardno);    fp_dac = fopen(string,"r");        dotset(4,20.0,0.0,1000.0,0.0,0,0);        sprintf(xstring,"charge");        sprintf(ystring,"high gain fermi peak");        dotlbl(4,xstring,ystring);        dotset(5,800.0,0.0,1000.0,0.0,0,0);        sprintf(xstring,"charge");        sprintf(ystring,"low gain fermi peak");        dotlbl(5,xstring,ystring);        dotset(8,20.0,0.0,5.0,-5.0,0,0);        sprintf(xstring,"charge");        sprintf(ystring,"high gain sigma");        dotlbl(8,xstring,ystring);        dotset(9,800.0,0.0,5.0,-5.0,0,0);        sprintf(xstring,"charge");        sprintf(ystring,"low gain sigma");        dotlbl(9,xstring,ystring);next:   nwds = fread(&dacs.nev,4,615,fp_dac);   ierr = feof(fp_dac);   if(ierr != 0) goto done;   ntotal++;   year = 1998;   month = dacs.month;   day = dacs.day;   hour = dacs.hour;   min = dacs.min;   sec = 0;      if(ntotal == 1)    {lyear = 1998;     lmonth = month;     lday = day;     lhour = hour;     lmin = min;     lsec = 0;    }/*   dmin = tinterval();   rad = 19.08 * dmin / 60.0;  */   rad = dacs.rad;   if(rad>10.0) goto done;   printf(" event=%d  nwds=%d  ierr=%d   %d/%d %d:%d  cap=%f  ped=%f+/-%f\n",          ntotal,nwds,ierr,dacs.month,dacs.day,          dacs.hour,dacs.min,dacs.cap,dacs.ped,dacs.dped);        n = dacs.nev;        if(dacs.cap<10.0)         { for(i=0;i<n;i++)           { dotacc(4,dacs.cg[i],dacs.amp[i]);             dotacc(8,dacs.cg[i],dacs.damp[i]);           }         }        if(dacs.cap>10.0)         { for(i=0;i<n;i++)           { dotacc(5,dacs.cg[i],dacs.amp[i]);             dotacc(9,dacs.cg[i],dacs.damp[i]);           }        }    goto next;done:  dotwrt(4);  dotwrt(5);  dotwrt(8);  dotwrt(9);  }tinterval() { static int daym[13] = {0,31,28,31,30,31,30,31,31,30,31,30,31};   int sday,dday,dhour,dmin,interval;   if(month == lmonth) dday = day - lday;   if(month != lmonth)      { sday = day + daym[lmonth];       dday = sday - lday;     }   dhour = hour - lhour;   dmin = min - lmin;   interval = dday * 1440 + dhour * 60 + dmin;/*   printf("now  %d/%d/%d %d:%d:%d\n",year,month,day,hour,min,sec);     printf("last %d/%d/%d %d:%d:%d\n",lyear,lmonth,lday,lhour,lmin,lsec);     printf("dday=%d  dhour=%d  dmin=%d\n",dday,dhour,dmin);  */   return(interval); }
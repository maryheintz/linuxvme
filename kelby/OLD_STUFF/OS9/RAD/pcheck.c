#include <stdio.h>#include <math.h>static struct {int nev;               int month;               int day;               int hour;               int min;               double cap;               double charge;               double mc[256];               double mp[256];               double rad;} phase;char xstring[80],ystring[80],string[80],err[80];int year,month,day,hour,min,sec;int lyear,lmonth,lday,lhour,lmin,lsec;main()  { FILE *fp_phase;    int n,ntotal=0,i,ierr,nwds,imaxl=-1,imaxh=-1,cardno,ll;    double dmin,rad,maxh=0.0,maxl=0.0;   dotset(1,250.0,0.0,750.0,250.0,0,0);   sprintf(xstring,"time bin");   sprintf(ystring,"high gain fermi peak");   dotlbl(1,xstring,ystring);   dotset(2,250.0,0.0,750.0,250.0,0,0);   sprintf(xstring,"time bin");   sprintf(ystring,"low gain fermi peak");   dotlbl(2,xstring,ystring);   dxyset(3,10.0,0.0,1000.0,0.0,0,0);   sprintf(xstring,"rad");   sprintf(ystring,"counts at peak highgain");   dxylbl(3,xstring,ystring);   dxyset(4,10.0,0.0,1000.0,0.0,0,0);   sprintf(xstring,"rad");   sprintf(ystring,"counts at peak lowgain");   dxylbl(4,xstring,ystring);    printf("input - card number\n");    fscanf(stdin,"%d",&cardno);    sprintf(string,"/z5/phase%d.dat",cardno);    fp_phase = fopen(string,"r");   ll = 0;next:   nwds = fread(&phase.nev,4,1037,fp_phase);   ierr = feof(fp_phase);   if(ierr != 0) goto done;   ntotal++;   printf(" ntotal=%d\n",ntotal);   year = 1998;   month = phase.month;   day = phase.day;   hour = phase.hour;   min = phase.min;   sec = 0;      if(ntotal == 1)    {lyear = 1998;     lmonth = month;     lday = day;     lhour = hour;     lmin = min;     lsec = 0;    }/*   dmin = tinterval();   rad = 19.08 * dmin / 60.0;  */   rad = phase.rad;   if(phase.cap<50.0) ll=0;   if(phase.cap>50.0) ll=1;   printf("ntotal=%d  rad=%f  cap=%f  mc=%f\n",      ntotal,rad,phase.cap,phase.mc[104]);   if(ntotal < 3)   { printf(" mc  cap=%f\n",phase.cap);     maxh = 0.0;     maxl = 0.0;     for(i=0;i<251;i++)      { if(phase.mc[i] > maxh && ll == 0 && i<175 && i>25)           {  maxh = phase.mc[i];             imaxh = i;           }        if(phase.mc[i] > maxl && ll == 1 && i<175 && i>25)           {  maxl = phase.mc[i];             imaxl = i;          }        printf("i=%d  mc=%f  mp=%f  %d  %d\n",         i,phase.mc[i],phase.mp[i],imaxl,imaxh); }        printf("imaxl=%d  imaxh=%d\n",imaxl,imaxh);   }    if(rad < 10.0)      { /* printf("plot phase\n"); */        for(i=0;i<251;i++)        { if(ll == 0) dotacc(1,(double)i,phase.mc[i]);          if(ll == 1) dotacc(2,(double)i,phase.mc[i]);        }      }   if(ll == 0)          { printf(" cap=%f  val=%f\n",phase.cap,phase.mc[imaxh]);       dxyacc(3,rad,phase.mc[imaxh],0.0,0);     }   if(ll == 1)      { printf(" cap=%f  val=%f\n",phase.cap,phase.mc[imaxl]);       dxyacc(4,rad,phase.mc[imaxl],0.0,0);     }    goto next;done:/*   dotwrt(1);   dotwrt(2);   dxywrt(3);   dxywrt(4);  */   dotmwr(2,1,2);   dxymwr(2,3,4); }tinterval() { static int daym[13] = {0,31,28,31,30,31,30,31,31,30,31,30,31};   int sday,dday,dhour,dmin,interval;   if(month == lmonth) dday = day - lday;   if(month != lmonth)      { sday = day + daym[lmonth];       dday = sday - lday;     }   dhour = hour - lhour;   dmin = min - lmin;   interval = dday * 1440 + dhour * 60 + dmin;/*   printf("now  %d/%d/%d %d:%d:%d\n",year,month,day,hour,min,sec);     printf("last %d/%d/%d %d:%d:%d\n",lyear,lmonth,lday,lhour,lmin,lsec);     printf("dday=%d  dhour=%d  dmin=%d\n",dday,dhour,dmin);  */   return(interval); }dxyfit(l,k,x)int l,k;double x;  { double dxyf;    dxyf = 0.0;    return(dxyf);  }
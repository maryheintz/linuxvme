#include <stdio.h>#include <math.h>#include "vme.h"unsigned int sw_base,fermi_base,vme_base,pio_base;main(argc,argv,envs)int argc;char *argv[];char *envs[];{    int card,zone,sector,l,wait,i;   unsigned short cadr,sval,dval;   vme_base = vme_a24_base();   sw_base = vme_base + 0xaa0000;   set_3in1_base(vme_base);    multi_low();    zone = 1;    sector = 1;    printf("argc=%d\n",argc);    if(argc != 3)     { zone = 1;       sector = 1;     }    if(argc == 3)     { sscanf(argv[1],"%d",&zone);       sscanf(argv[2],"%d",&sector);       printf("zone %d  sector %d\n",zone,sector);     }start:   for(i=0;i<49;i++)    { card = i;      l = (zone<<12) | (sector<<6) | card;      cadr = (unsigned short)l;      card_sel(cadr);      sval = (unsigned short)0x555;      wrt_shift(13,sval);      read_shift(&dval);      if(sw(2) == 1) printf("card %d 555 dval = %x\n",card,dval&0xfff);      if(sval != (dval&0xfff) ) goto fail;      sval = (unsigned short)0xaaa;      wrt_shift(13,sval);      read_shift(&dval);      if(sw(2) == 1) printf("       aaa dval = %x\n",dval&0xfff);      if(sval != (dval&0xfff) ) goto fail;      printf(" card=%d  OK\n",i);      continue;fail:      continue;    }  if(sw(1) == 1) goto start;  printf(" wait\n");  i=getchar();  goto start; }fpsw(int i)  { int ent=0,l;    unsigned long *pio,kk;    if(ent==0)       { pio_base = vme_base + 0x570000;        pio = (unsigned long *)pio_base;        ent=1;}    kk = *pio;    l = (kk>>i) & 1;/*    printf(" fpsw i=%d  val=%d\n",i,l);  */    return(l);  }sw(i)int i;{ int k,l,shift;  unsigned short *adr;  (unsigned short *)adr = (unsigned short *)(sw_base + 0x0c);  k = *adr;  shift = i-1;  l = (k>>shift) & 1;  return(l);}
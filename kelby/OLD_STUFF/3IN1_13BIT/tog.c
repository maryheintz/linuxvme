#include <stdio.h>#include <math.h>#include "vme.h"char string[1000];unsigned int sw_base,fermi_base,vme_base,pio_base;int ent=0;main(){    int isw[6],i1,i2,ll,i,mode,s1,s2,s3,s4,itr,ire,mse,tpS,tpL,trg,sw1,dacset;   int card,zone,sector,tube,l;   unsigned short cadr,sval,dval,tval,t1val,t2val;   double fmin,ratio,volt[6],ped[6],expr[6],volts;   int max[6],del[6],gain;   vme_base = vme_a24_base();   fermi_base = vme_base + 0xee0000;   sw_base = vme_base + 0xaa0000;   set_3in1_base(vme_base);   zone=1;   sector=1;   card=38;   l = (zone<<12) | (sector<<6) | card;   cadr = (unsigned short)l;   card_sel(cadr);   multi_low();   tval = (unsigned short)100;   tim1_set(tval);   tval = (unsigned short)50;   tim2_set(tval);   rtime();   printf(" toggling integrator switches 2 sec\n");       send4_3in1(4,1);      /* enable small C */       send4_3in1(5,1);      /* enable large C */loop27:       send13_3in1(0,0);       send13_3in1(1,0);       send13_3in1(2,0);       tp_low();       sleep(2);       send13_3in1(0,1);       send13_3in1(1,1);       send13_3in1(2,0xf);       tp_high();       sleep(2);       if(cadr != 0xfff) goto loop27;}fpsw(int i)  { int ent=0,l;    unsigned long *pio,kk;    if(ent==0)       { pio_base = vme_base + 0x570000;        pio = (unsigned long *)pio_base;        ent=1;}    kk = *pio;    l = (kk>>i) & 1;/*    printf(" fpsw i=%d  val=%d\n",i,l);  */    return(l);  }sw(i)int i;{ int k,l,shift;  unsigned short *adr;  (unsigned short *)adr = (unsigned short *)(sw_base + 0x0c);  k = *adr;  shift = i-1;  l = (k>>shift) & 1;  printf("k=%x  l=%x\n",k,l);  return(l);}    go_get(v)      double *v;      {double volts,factor;       unsigned short kk,*reg;       factor = 1.0;       reg = (unsigned short *) (vme_base+0xdd0018);       *reg = 0;  /* set convert to low */       reg = (unsigned short *) (vme_base+0xdd000c);       *reg = 0;  /* set convert to high */       sleep(1);       reg = (unsigned short *) (vme_base+0xdd000e);       kk = *reg;  /* read data */       volts = factor * (double)(kk & 0xfff);	*v = volts;          return(0);      }